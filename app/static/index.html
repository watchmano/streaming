<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>AI ë”°ë¼í•˜ê¸° ìŠ¤íŠ¸ë¦¬ë°</title>
  <style>
    body { font-family: 'Arial', sans-serif; margin: 0; padding: 0; background-color: #1c1c1c; color: white; }
    .container { max-width: 800px; margin: auto; padding: 2rem; }
    h1 { text-align: center; margin-bottom: 2rem; }
    .input-group { display: flex; flex-direction: column; gap: 1rem; }
    input, select, button {
      padding: 0.7rem; font-size: 1rem; border: none; border-radius: 8px;
    }
    input, select { background-color: #333; color: white; }
    button { background-color: #4caf50; color: white; cursor: pointer; }
    button:hover { background-color: #45a049; }
    .script-box {
      background: #2a2a2a; padding: 1rem; border-radius: 8px; margin-top: 2rem; min-height: 100px;
    }
    .player-controls { margin-top: 2rem; display: flex; align-items: center; gap: 1rem; }
    audio { width: 100%; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ¤ AI ë”°ë¼í•˜ê¸° ìŠ¤íŠ¸ë¦¬ë°</h1>
    <div class="input-group">
      <input type="text" id="youtubeUrl" placeholder="ìœ íŠœë¸Œ ë§í¬ ë¶™ì—¬ë„£ê¸°" />
      <select id="level">
        <option value="easy">ğŸ‘¶ ì´ˆê¸‰</option>
        <option value="medium">ğŸ§’ ì¤‘ê¸‰</option>
        <option value="hard">ğŸ§  ê³ ê¸‰</option>
      </select>
      <button type="button" onclick="startStreaming()">ì‹œì‘í•˜ê¸°</button>
    </div>
    <div class="script-box" id="scriptBox">ğŸ§ ìŠ¤í¬ë¦½íŠ¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</div>
    <div class="player-controls">
      <audio id="audioPlayer" controls></audio>
      <button type="button" onclick="repeatPlay()">ğŸ” ë°˜ë³µ</button>
    </div>
  </div>
  <script>
    async function startStreaming() {
      const url = document.getElementById('youtubeUrl').value;
      const level = document.getElementById('level').value;
      const form = new FormData();
      form.append("youtubeUrl", url);
      form.append("level", level);
  
      const scriptBox = document.getElementById('scriptBox');
      const audioPlayer = document.getElementById('audioPlayer');
  
      scriptBox.innerHTML = "ğŸ§ ì²˜ë¦¬ ì¤‘ì…ë‹ˆë‹¤... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”.";
  
      try {
        const res = await fetch("http://localhost:8000/api/process", { method: "POST", body: form });
        const data = await res.json();
  
        if (data.error) {
          scriptBox.innerHTML = "âŒ ì˜¤ë¥˜: " + data.error;
          return;
        }
  
        scriptBox.innerHTML = data.script.map(line => `ğŸ—£ï¸ ${line}`).join("<br>");
        audioPlayer.src = data.audioUrl;
  
        await audioPlayer.play().catch(err => {
          console.warn("ğŸ§ ìë™ ì¬ìƒ ì‹¤íŒ¨:", err);
          scriptBox.innerHTML += "<br><br>âš ï¸ ìë™ ì¬ìƒì´ ì°¨ë‹¨ë˜ì–´ ìˆ˜ë™ìœ¼ë¡œ ì¬ìƒ ë²„íŠ¼ì„ ëˆŒëŸ¬ì•¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
        });
  
      } catch (e) {
        console.error("âŒ ìš”ì²­ ì¤‘ ì—ëŸ¬ ë°œìƒ:", e);
        scriptBox.innerHTML = "âŒ ìš”ì²­ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
      }
    }
  
    function repeatPlay() {
      const audio = document.getElementById("audioPlayer");
      audio.currentTime = 0;
      audio.play();
    }
  </script>
  
</body>
</html>